INIT_LCD:
    LDI R20, 0x04
INIT_RESET:
    CALL DELAY
    LDI R16, 0b00110000
    OUT PORTD, R16
    CALL ENABLE
    CALL DELAY
    LDI R16, 0b00110000
    OUT PORTD, R16
    CALL ENABLE
    CALL DELAY
    LDI R16, 0b00110000
    OUT PORTD, R16
    CALL ENABLE
    CALL DELAY
    LDI R16, 0b00100000
    OUT PORTD, R16
    CALL ENABLE
    CALL DELAY
    LDI R16, 0x28
    CALL INSTRUCCION
    LDI R16, 0x0F
    CALL INSTRUCCION
    LDI R16, 0x01
    CALL INSTRUCCION
    LDI R16, 0x12
    CALL INSTRUCCION
    LDI R16, 0x02
    CALL INSTRUCCION
FIN:
    RJMP FIN
send4bits_LCD:
INSTRUCCION:
    MOV R17, R16
    ANDI R17, 0xF0
    CALL LEERINST
    MOV R17, R16
    ANDI R17, 0x0F
    SWAP R17
    CALL LEERINST
    RET
LEERINST:
    OUT PORTD, R17
    CBI PORTD, RS
    CBI PORTD, RW
    CALL ENABLE
    CALL DELAY
    RET
DATOS:
    MOV R17, R16
    ANDI R17, 0xF0
    CALL LEERDAT
    MOV R17, R16
    ANDI R17, 0x0F
    SWAP R17
    CALL LEERDAT
    RET
LEERDAT:
    OUT PORTD, R17
    SBI PORTD, RS
    CBI PORTD, RW
    CALL ENABLE
    CALL DELAY
    RET
gotoXY_LCD:
    LDI R21, 0x80
    ADD R16, R21
    CALL INSTRUCCION
    RET
ENABLE:
    CBI PORTD, 2
    CALL DELAY
    SBI PORTD, 2
    CALL DELAY
    CBI PORTD, 2
    RET
DELAY:
    LDI R25, 200
CICLO2:
    LDI R26, 255
CICLO1:
    DEC R26
    BRNE CICLO1
    DEC R25
    BRNE CICLO2
    RET
